<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>宸汐缘</title><meta name="author" content="Cheney"><meta name="copyright" content="Cheney"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="中年程序猿的自我救赎，记录日常的技术整理和心得分享，涉及技术栈:SQL,Java,Python,Oracle,MySQL,大数据等">
<meta property="og:type" content="website">
<meta property="og:title" content="宸汐缘">
<meta property="og:url" content="https://www.cheneyblog.com/page/9/index.html">
<meta property="og:site_name" content="宸汐缘">
<meta property="og:description" content="中年程序猿的自我救赎，记录日常的技术整理和心得分享，涉及技术栈:SQL,Java,Python,Oracle,MySQL,大数据等">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.cdn.cheneyblog.com/blog/202307291649261.jpg">
<meta property="article:author" content="Cheney">
<meta property="article:tag" content="SQL,Java,Python,Oracle,MySQL,大数据">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.cdn.cheneyblog.com/blog/202307291649261.jpg"><link rel="shortcut icon" href="https://www.cdn.cheneyblog.com/blog/202307211052086.png"><link rel="canonical" href="https://www.cheneyblog.com/page/9/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '宸汐缘',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-01-18 16:20:19'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://www.cdn.cheneyblog.com/blog/202307291649261.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">123</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa fa-desktop"></i><span> 前端</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/HtmlCss"><i class="fa-fw fa fa-area-chart"></i><span> Html/Css</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-code"></i><span> 后端</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Java"><i class="fa-fw fas fa-stream"></i><span> Java</span></a></li><li><a class="site-page child" href="/Python"><i class="fa-fw fa fa-sitemap"></i><span> Python</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-database"></i><span> 数据库</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Oracle"><i class="fa-fw fa-sharp fa-solid fa-database"></i><span> Oracle</span></a></li><li><a class="site-page child" href="/categories/TDSQL"><i class="fa-fw fa-solid fa-server"></i><span> TDSQL</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/Tools"><i class="fa-fw fas fa-toolbox"></i><span> 工具</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-project-diagram"></i><span> 猿料百科</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Digitalize"><i class="fa-fw fas fa-percentage"></i><span> 数字化</span></a></li><li><a class="site-page child" href="/WebEcology"><i class="fa-fw fa-solid fa-globe"></i><span> Web生态</span></a></li><li><a class="site-page child" href="/AI"><i class="fa-fw fa-brands fa-airbnb"></i><span> AI</span></a></li></ul></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://5b0988e595225.cdn.sohucs.com/images/20180114/1dec553b2b88499c871b097e299dafcc.gif')"><nav id="nav"><span id="blog-info"><a href="/" title="宸汐缘"><img class="site-icon" src="https://www.cdn.cheneyblog.com/blog/202307211053392.png"/><span class="site-name">宸汐缘</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa fa-desktop"></i><span> 前端</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/HtmlCss"><i class="fa-fw fa fa-area-chart"></i><span> Html/Css</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-code"></i><span> 后端</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Java"><i class="fa-fw fas fa-stream"></i><span> Java</span></a></li><li><a class="site-page child" href="/Python"><i class="fa-fw fa fa-sitemap"></i><span> Python</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-database"></i><span> 数据库</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Oracle"><i class="fa-fw fa-sharp fa-solid fa-database"></i><span> Oracle</span></a></li><li><a class="site-page child" href="/categories/TDSQL"><i class="fa-fw fa-solid fa-server"></i><span> TDSQL</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/Tools"><i class="fa-fw fas fa-toolbox"></i><span> 工具</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-project-diagram"></i><span> 猿料百科</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Digitalize"><i class="fa-fw fas fa-percentage"></i><span> 数字化</span></a></li><li><a class="site-page child" href="/WebEcology"><i class="fa-fw fa-solid fa-globe"></i><span> Web生态</span></a></li><li><a class="site-page child" href="/AI"><i class="fa-fw fa-brands fa-airbnb"></i><span> AI</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">宸汐缘</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="mailto:850318517@qq.com" target="_blank" title="Email"><i class="far fa-envelope"></i></a><a class="social-icon" href="https://gitee.com/henry-chr" target="_blank" title="Gitee"><i class="fab fa-github"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/posts/49498.html" title="看懂执行计划之优化器的模式"><img class="post-bg" src="https://www.cdn.cheneyblog.com/blog/202309151442953.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="看懂执行计划之优化器的模式"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/49498.html" title="看懂执行计划之优化器的模式">看懂执行计划之优化器的模式</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-15T06:41:16.000Z" title="发表于 2023-09-15 14:41:16">2023-09-15</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-11T01:27:49.038Z" title="更新于 2024-01-11 09:27:49">2024-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Oracle/">Oracle</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Oracle/">Oracle</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a class="twikoo-count" href="/posts/49498.html#post-comment"><i class="fa-solid fa-spinner fa-spin"></i></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">简介&emsp;&emsp;优化器是 Oracle 的内置软件，可以确定执行目标 SQL 的最有效方式。优化器的模式决定 Oracle 解析目标 SQL 时所用优化器的类型，以及决定使用 CBO 时计算成本的侧重点。优化器的模式不同，CBO 计算成本值的方法也不同。控制 Oracle 优化器模式的参数为 optimizer_mode。

查看参数

1show parameter optimizer_mode


修改参数

1alter session set optimizer_mode=&#x27;CHOOSE&#x27;

RULE表示优化器采用 RBO 来解析目标 SQL。是 Oracle 早期版本的一种优化模式。目前 Oracle 已不再更新 RBO，也不推荐使用 RBO。
CHOOSE由 RBO 到 CBO 转换时的默认值。表示既可以使用 RBO 又可以使用 CBO。取决于 SQL 涉及的对象是否有统计信息，有统计信息 CBO（部分有时会采样统计），否则 RBO。
FIRST_ROWS_n(n=1,10,100,1000)Oracle 采用 CBO 解析目标 SQL。侧重 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/61.html" title="看懂执行计划之基于成本的优化器（CBO）"><img class="post-bg" src="https://www.cdn.cheneyblog.com/blog/202309151433133.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="看懂执行计划之基于成本的优化器（CBO）"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/61.html" title="看懂执行计划之基于成本的优化器（CBO）">看懂执行计划之基于成本的优化器（CBO）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-15T06:38:11.000Z" title="发表于 2023-09-15 14:38:11">2023-09-15</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-11T01:27:49.036Z" title="更新于 2024-01-11 09:27:49">2024-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Oracle/">Oracle</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Oracle/">Oracle</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a class="twikoo-count" href="/posts/61.html#post-comment"><i class="fa-solid fa-spinner fa-spin"></i></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">基于代价的优化方式&emsp;&emsp;Cost-Based Optimization，简称 CBO。CBO 选择目标 SQL 执行计划的判断原则是成本，从目标 SQL 的诸多执行计划中选取成本值最小的执行路径为其执行计划，各执行路径的成本值是根据目标 SQL 中涉及到的表、索引、列等相关对象的统计信息计算出来的，实际反应执行目标 SQL 所要消耗的 I/O、CPU 和网络资源的一个估计值。

I/O把数据从磁盘读入内存时所需代价(Select 重点指标)
CPU处理内存中数据所需的代价（排序(sort)、连接(join)操作）
网络资源网络资源是指那些用了 dblink 的分布式目标 SQL，CBO 在解析该类目标 SQL 时知道在实际执行时所需要的的数据并不在本地数据库中（需要远程数据库取数），便会将网络资源消耗折算成对等的 I/O 资源消耗再进行估算。
动态采样执行 SQL 所涉及对象（表、索引等）没有被分析、统计过，Oracle 就会使用动态采样，动态的收集表和索引上的一些数据信息，但这些统计信息不会记录在视图中，只在硬解析时才会使用动态采样。

CBO 组成
查询转化器（Q ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/65395.html" title="看懂执行计划之基于规则的优化器（RBO）"><img class="post-bg" src="https://www.cdn.cheneyblog.com/blog/202309151433133.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="看懂执行计划之基于规则的优化器（RBO）"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/65395.html" title="看懂执行计划之基于规则的优化器（RBO）">看懂执行计划之基于规则的优化器（RBO）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-15T06:31:41.000Z" title="发表于 2023-09-15 14:31:41">2023-09-15</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-11T01:27:49.035Z" title="更新于 2024-01-11 09:27:49">2024-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Oracle/">Oracle</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Oracle/">Oracle</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a class="twikoo-count" href="/posts/65395.html#post-comment"><i class="fa-solid fa-spinner fa-spin"></i></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">简介&emsp;&emsp;基于规则的优化器（RBO）是通过编码在 Oracle 数据库中的一系列固定的规则，来决定目标 SQL 的执行计划。Oracle 事先给各种类型的执行路径定一个等级，从 1 到 15，等级 1 对应执行路径的执行效率最高，等级 15 对应执行路径的执行效率最低。对于等级相同的执行计划，oracle 根据目标对象在数据字典中缓存的顺序判断选择哪一种执行计划。在决定目标 SQL 的执行计划时，RBO 会从该 SQL 的诸多执行路径中选择一条等级最低的执行路径来作为其执行计划。&emsp;&emsp;RBO 中等级 1 对应的执行路径是“single row by rowid（通过 rowID 来访问单行数据）”，等级 15 所对应的执行路径时“full table scan（全表扫描）”。
RBO 的缺陷
RBO 的执行计划很难调整
目标 SQL 的写法及各个对象在该 SQL 文本中出现的先后顺序都会影响执行计划
Oracle 数据中的很多新特性、功能，均不支持 RBO
没有考虑目标 SQL 所涉及对象的实际数据量

RBO 执行计划的调整
等价改写 SQL
Nu ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/35895.html" title="看懂执行计划之位图索引"><img class="post-bg" src="https://www.cdn.cheneyblog.com/blog/202309151426648.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="看懂执行计划之位图索引"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/35895.html" title="看懂执行计划之位图索引">看懂执行计划之位图索引</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-15T06:25:09.000Z" title="发表于 2023-09-15 14:25:09">2023-09-15</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-11T01:27:48.939Z" title="更新于 2024-01-11 09:27:48">2024-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Oracle/">Oracle</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Oracle/">Oracle</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a class="twikoo-count" href="/posts/35895.html#post-comment"><i class="fa-solid fa-spinner fa-spin"></i></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">定义&emsp;&emsp;目前一般我们使用的索引都是 B-Tree 索引，索引结构中存储的是键值和对应 ROWID。位图索引是指用位图表示的索引，通常创建在有大量重复值的列上，针对每个键值建立不同的位图。索引结构中主要存储键值、起止 ROWID 和位置编码，位置编码中的每一位表示键值对应数据行的有无，一个块可能指向多行数据的位置。

位图索引通过位图向量，表示索引键值在表中的分布
存在大量更新操作的列上不宜建位图索引，因为更新向量时相应键值涉及到的数据行都将被锁定

与 B-Tree 索引的区别
位图索引一个键值对应一个叶子节点，B-Tree 索引一个叶子节点包含多个索引键值
位图索引使用位图向量标识键值对应数据行的分布，B-Tree 采用 Row_id 定位数据行
位图索引创建不需要排序，B-Tree 索引需要排序
位图索引允许键值为 Null，B-Tree 索引对 Null 值敏感
位图索引可以进行位运算（and、or）

位图索引优缺点优点
位图索引由于只存储键值的起止 Rowid 和位图,占用的空间非常少.
位图索引创建时不需要排序，创建速度快
位图索引对 Null 值不敏感 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/26997.html" title="看懂执行计划之 B-Tree 索引"><img class="post-bg" src="https://www.cdn.cheneyblog.com/blog/202309151422644.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="看懂执行计划之 B-Tree 索引"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/26997.html" title="看懂执行计划之 B-Tree 索引">看懂执行计划之 B-Tree 索引</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-15T06:21:52.000Z" title="发表于 2023-09-15 14:21:52">2023-09-15</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-11T01:27:48.939Z" title="更新于 2024-01-11 09:27:48">2024-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Oracle/">Oracle</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Oracle/">Oracle</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a class="twikoo-count" href="/posts/26997.html#post-comment"><i class="fa-solid fa-spinner fa-spin"></i></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">B-Tree 索引内部结构
&emsp;&emsp;B-Tree 是一种常见的数据结构，可以显著减少定位记录时所经历的中间过程，从而加快存取速度，主要用于 OLTP 系统（事务系统）。B-Tree 索引包含的主要组件如下：

根节点（Root Node）：一个 B-Tree 索引只有一个根节点，它实际就是位于树的最顶端的分支节点。
分支节点（Branch Node）：包含指向相应索引分支块或叶子块的指针和索引键值列。
叶子节点（Leaf Node）：包含被索引键值和该键值对应的 ROWID
索引项（Index Entry）：对应每一条行记录

分支节点（Branch Node）&emsp;&emsp;分支节点主要包括两部分：指针和索引键值列。

指针指针是指相关分支块或叶子块的块地址 RDBA。每个分支块都会有两种类型的指针，一种是 LMC（Left Most Child），比当前节点中最小的索引值还小的下一级节点块的数据块地址；另外一种是索引行记录指针即下一级节点块地址，该指针指向块的索引键值列最小值一定大于或等于该行记录的索引键值
索引键值列索引键值列只要 Oracle 能区分相应 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/9739.html" title="看懂执行计划之索引介绍"><img class="post-bg" src="https://www.cdn.cheneyblog.com/blog/202309151353036.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="看懂执行计划之索引介绍"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/9739.html" title="看懂执行计划之索引介绍">看懂执行计划之索引介绍</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-15T05:51:36.000Z" title="发表于 2023-09-15 13:51:36">2023-09-15</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-11T01:27:48.938Z" title="更新于 2024-01-11 09:27:48">2024-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Oracle/">Oracle</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Oracle/">Oracle</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a class="twikoo-count" href="/posts/9739.html#post-comment"><i class="fa-solid fa-spinner fa-spin"></i></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">简介&emsp;&emsp;索引是建立在表上的可选数据库对象，是一组排序后的的索引键。主要用于加快数据的检索，类似于书籍的目录，快速定位到目标数据。索引在物理上和逻辑上都是独立的，创建或删除索引对基表不会有影响。当对基表进行 DML 操作时 Oracle 会自动管理索引，无需手动处理。
索引分类结构分类
分区索引

索引按范围（Range）或散列（Hash，Oracle 10g中引入）进行分区一个分区索引可能指向任何（或全部的）表分区。

B-Tree 索引

B-Tree索引是一个典型的树结构，通常包含根节点、分支节点、叶子节点包括正常索引或反转关键字索引

位图索引

位图索引主要针对大量相同值的列而创建位图索引不直接存储ROWID，而是存储字节位到ROWID的映射位图索引的空间占用明显小于B-Tree索引位图索引不适合经常更新的表关键字BitMap
逻辑分类
单列索引

索引列为单个字段

组合索引

索引列为多个字段，最多为32列，顺序自定义

唯一索引

索引列的值唯一，Oracle会自动在表的主键列上创建唯一索引，关键字UNIQUE INDEX

非唯一索引

索引列的值允 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/47150.html" title="深入解析Oracle数据库的综合体系结构与各组成部分的作用"><img class="post-bg" src="https://www.cdn.cheneyblog.com/blog/202309141417233.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="深入解析Oracle数据库的综合体系结构与各组成部分的作用"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/47150.html" title="深入解析Oracle数据库的综合体系结构与各组成部分的作用">深入解析Oracle数据库的综合体系结构与各组成部分的作用</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-14T06:16:05.000Z" title="发表于 2023-09-14 14:16:05">2023-09-14</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-11T01:27:49.059Z" title="更新于 2024-01-11 09:27:49">2024-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Oracle/">Oracle</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Oracle/">Oracle</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a class="twikoo-count" href="/posts/47150.html#post-comment"><i class="fa-solid fa-spinner fa-spin"></i></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">Oracle数据库作为一款强大的关系型数据库管理系统，具有复杂而完善的综合体系结构。这个体系结构由物理结构、内存结构、进程结构和逻辑结构组成，它们相互协作，共同为数据库提供高效的数据存储、管理和访问。本文将深入解析Oracle数据库的综合体系结构，探讨各组成部分之间的联系以及它们对数据库的影响与作用。


物理结构物理结构是指数据库在磁盘上的存储方式和组织形式。它涉及到数据文件、数据块、操作系统文件系统等层面的存储结构。物理结构的设计和调优对于数据库的性能和性能是至关重要的，它直接影响着数据的读取和写入速度，以及数据库的可靠性和可用性。
内存结构内存结构是指Oracle数据库在内存中分配和管理的存储区域。它包括了共享池、数据库缓存、重做日志缓冲区等重要的内存组件。内存结构的设计和配置对于数据库的性能优化和响应速度具有重要影响。合理配置内存结构可以降低磁盘IO操作的频率，提升数据检索和事务处理的效率。
进程结构进程结构是指Oracle数据库的进程组成和协作方式。它包括了实例进程、后台进程和用户进程等多个进程。不同的进程负责着不同的任务和功能，它们相互配合，保证数据库实例的正常运行和对外服 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/24947.html" title="深入了解Oracle数据库的逻辑结构与数据组织方式"><img class="post-bg" src="https://www.cdn.cheneyblog.com/blog/202309141411371.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="深入了解Oracle数据库的逻辑结构与数据组织方式"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/24947.html" title="深入了解Oracle数据库的逻辑结构与数据组织方式">深入了解Oracle数据库的逻辑结构与数据组织方式</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-14T06:09:43.000Z" title="发表于 2023-09-14 14:09:43">2023-09-14</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-11T01:27:49.058Z" title="更新于 2024-01-11 09:27:49">2024-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Oracle/">Oracle</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Oracle/">Oracle</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a class="twikoo-count" href="/posts/24947.html#post-comment"><i class="fa-solid fa-spinner fa-spin"></i></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">逻辑结构图
表空间（Tablespace）表空间是 Oracle 最大的逻辑存储结构，与物理上的数据文件相对应，但是一个表空间可以拥有多个数据文件。

数据表空间用于存储用户数据的普通表空间。
系统表空间默认的表空间，用于保存数据字典（一组保存数据库自身信息的内部系统表和视图，及用于 Oracle 内部使用的其他一些对象），保存所有的 PL/SQL 程序的源代码和解析代码，包括存储过程和函数、包、数据库触发器等，保存数据库对象（表、视图、序列）的定义。
回滚表空间用于存放回滚段,每个实例最多只能使用一个撤销表空间
临时表空间存储 SQL 执行过程中产生的临时数据

段（Segment）段是一组盘区，它是一个独立的逻辑存储结构，用于存储具有独立存储结构对象的全部数据。段一般是数据库终端用户处理最小的存储单位，当段的数据区已满，Oracle 为其分配另一个数据区，段的数据区在磁盘上可能是不连续的。

数据段用来存储表中所有数据；
索引段用来存储表中索引的所有数据；
临时段用于存储表排序或汇总时产生的临时数据
LOB 段LOB 用来存储表中大型数据对象，例如 CLOB 与 BLOB
回退段用 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/35730.html" title="深入了解Oracle数据库的进程结构"><img class="post-bg" src="https://www.cdn.cheneyblog.com/blog/202309141406310.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="深入了解Oracle数据库的进程结构"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/35730.html" title="深入了解Oracle数据库的进程结构">深入了解Oracle数据库的进程结构</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-14T06:04:01.000Z" title="发表于 2023-09-14 14:04:01">2023-09-14</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-11T01:27:49.057Z" title="更新于 2024-01-11 09:27:49">2024-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Oracle/">Oracle</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Oracle/">Oracle</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a class="twikoo-count" href="/posts/35730.html#post-comment"><i class="fa-solid fa-spinner fa-spin"></i></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">Oracle 进程结构图
用户进程&emsp;&emsp;用户进程是一个与 Oracle 服务器进行交互的程序。一般的客户端软件，像 Oracle 的 sqlplus，sql developer,或者是一些驱动程序等等向数据库发送请求时即创建了用户进程。
服务器进程&emsp;&emsp;当监听程序监听到客户端来了一个请求，在创建会话时便会为其分配一个对应的服务器进程。服务器进程的主要作用就是处理连接到当前实例的用户进程的请求，对客户端发来的 sql 进行执行并返回执行结果。
后台进程后台进程是 Oracle 数据库为了保持最佳系统性能和协调多个用户请求而设置的一系列后台进程。
进程监控（PMON）对故障的进程执行恢复操作，负责清理内存存储区和释放该进程所使用的资源周期的检查调度进程和服务器进程的状态，对已死的进程进行重启
系统监控（SMON）当数据库实例出现故障或者系统崩溃的时候，执行恢复操作定期合并字典管理的表空间中的空闲空间在系统重启期间，清理表空间所有临时段安装和打开数据库
数据写入（DBWn）负责的将更新完的缓冲区数据写入磁盘中。以下情况发生时执行：

没有可以写入的缓存空间 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/14901.html" title="深入了解Oracle数据库的内存结构"><img class="post-bg" src="https://www.cdn.cheneyblog.com/blog/202309141110275.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="深入了解Oracle数据库的内存结构"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/14901.html" title="深入了解Oracle数据库的内存结构">深入了解Oracle数据库的内存结构</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-14T03:08:52.000Z" title="发表于 2023-09-14 11:08:52">2023-09-14</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-11T01:27:49.056Z" title="更新于 2024-01-11 09:27:49">2024-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Oracle/">Oracle</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Oracle/">Oracle</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a class="twikoo-count" href="/posts/14901.html#post-comment"><i class="fa-solid fa-spinner fa-spin"></i></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">Oracle 内存结构图
System Global Aera （SGA）
V$SGASTAT 视图提供有关 SGA 更详细的内存分配信息。
V$SGA 视图给出了系统全局区(System Global Area，SGA)内存结构的摘要信息。
数据库缓存区（Database Buffer Cache）&emsp;&emsp;用于缓存当前或最近使用的从磁盘读取的数据块的拷贝，来优化数据库的 I/O 减少物理读/写。Oralce 依据 LRU 算法对该内存区域进行 block-level 的更新。数据高速缓存块又由以下几个缓存块组成：

脏缓存块（Dirty buffers）保存被修改过并且 commit 但未写入磁盘数据的缓存块，脏缓存块最终被 DBWn 进程写入到硬盘的数据文件中永久保存。
命中缓存块（Pinned buffers）保存最近正在被访问的缓存块，始终被保留在数据高速缓存中，不会被写入数据文件。
空闲缓存块（Free buffers）该缓存块中没有数据，等待被写入数据。oracle 从数据文件中读取数据后，寻找空闲缓存块，以便写入其中。

日志缓冲区（Redo Log Bu ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/8/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/#content-inner">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/#content-inner">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/#content-inner">13</a><a class="extend next" rel="next" href="/page/10/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://www.cdn.cheneyblog.com/blog/202307291649261.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Cheney</div><div class="author-info__description">中年程序猿的自我救赎，记录日常的技术整理和心得分享，涉及技术栈:SQL,Java,Python,Oracle,MySQL,大数据等</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">123</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://gitee.com/henry-chr"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:850318517@qq.com" target="_blank" title="Email"><i class="far fa-envelope"></i></a><a class="social-icon" href="https://gitee.com/henry-chr" target="_blank" title="Gitee"><i class="fab fa-github"></i></a></div></div><div class="card-widget tzy-right-widget" id="card-wechat"><div id="flip-wrapper"><div id="flip-content"><div class="face"></div><div class="back face"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size: 1.19em; color: rgb(140, 35, 58)">AI (2)</a><a href="/tags/Digitalize/" style="font-size: 1.15em; color: rgb(32, 56, 56)">Digitalize (1)</a><a href="/tags/HtmlCss/" style="font-size: 1.15em; color: rgb(141, 34, 101)">HtmlCss (1)</a><a href="/tags/TDSQL/" style="font-size: 1.15em; color: rgb(200, 66, 85)">TDSQL (1)</a><a href="/tags/MySQL/" style="font-size: 1.15em; color: rgb(55, 164, 140)">MySQL (1)</a><a href="/tags/Web%E7%94%9F%E6%80%81/" style="font-size: 1.41em; color: rgb(116, 58, 53)">Web生态 (17)</a><a href="/tags/Java%E5%9F%BA%E7%A1%80/" style="font-size: 1.41em; color: rgb(67, 197, 101)">Java基础 (17)</a><a href="/tags/Java%E7%B1%BB%E5%BA%93/" style="font-size: 1.3em; color: rgb(146, 171, 157)">Java类库 (6)</a><a href="/tags/Oracle/" style="font-size: 1.45em; color: rgb(105, 109, 114)">Oracle (43)</a><a href="/tags/Python%E5%9F%BA%E7%A1%80/" style="font-size: 1.34em; color: rgb(24, 137, 46)">Python基础 (13)</a><a href="/tags/Conda/" style="font-size: 1.22em; color: rgb(143, 162, 54)">Conda (3)</a><a href="/tags/Docker/" style="font-size: 1.22em; color: rgb(73, 122, 100)">Docker (3)</a><a href="/tags/Hexo/" style="font-size: 1.15em; color: rgb(68, 158, 82)">Hexo (1)</a><a href="/tags/OracleSQL/" style="font-size: 1.26em; color: rgb(170, 55, 25)">OracleSQL (5)</a><a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 1.38em; color: rgb(89, 8, 34)">爬虫 (14)</a></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">123</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2023-07-16T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">113.1k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-01-18T08:20:17.600Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024  <i id="heartbeat" class="fa fas fa-heartbeat"></i> Cheney</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><p><a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.js"></script><div class="js-pjax"><script>(() => { 
  const getCommentUrl = () => {
    const eleGroup = document.querySelectorAll('#recent-posts .article-title')
    let urlArray = []
    eleGroup.forEach(i=>{
      urlArray.push(i.getAttribute('href'))
    })
    return urlArray
  }

  const getCount = () => {
    const runTwikoo = () => {
      twikoo.getCommentsCount({
        envId: 'https://my-twikoo-seven-gamma.vercel.app/',
        region: '',
        urls: getCommentUrl(),
        includeReply: false
      }).then(function (res) {
        document.querySelectorAll('#recent-posts .twikoo-count').forEach((item,index) => {
          item.textContent = res[index].count
        })
      }).catch(function (err) {
        console.log(err)
      })
    }

      if (typeof twikoo === 'object') {
        runTwikoo()
      } else {
        getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/twikoo/1.4.18/twikoo.all.min.js').then(runTwikoo)
      }
  }

  window.pjax ? getCount() : window.addEventListener('load', getCount)

})()</script><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/typed.js/2.0.12/typed.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["程序是为人而写，偶尔也供机器读取。","程序员有两个最大的敌人：计算机和程序员自己。","软件设计就是组织复杂性的艺术。","代码是写给人看的，顺便给机器执行。"])
  } else {
    document.getElementById("subtitle").textContent = "程序是为人而写，偶尔也供机器读取。"
  }
}
typedJSFn.run(subtitleType)</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://my-twikoo-seven-gamma.vercel.app/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/twikoo/1.4.18/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script data-pjax defer src="https://npm.elemecdn.com/tzy-blog/lib/js/theme/chocolate.js"></script><canvas id="universe"></canvas><script src="/js/custom.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="1024,Java,Python,SQL,Oracle,MySql,Vue,Hexo,Linux,Shell,C++,Html,CSS" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:24%;}.categoryBar-list{max-height: 380px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 320px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(https://www.cdn.cheneyblog.com//blog/202401171625630.webp);"> <a class="categoryBar-list-link" href="categories/AI/">AI</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">人工智能</span></li><li class="categoryBar-list-item" style="background:url(https://www.cdn.cheneyblog.com//blog/202401171639015.jpeg);"> <a class="categoryBar-list-link" href="categories/Digitalize/">Digitalize</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">数字化</span></li><li class="categoryBar-list-item" style="background:url(https://www.cdn.cheneyblog.com//blog/202401171643023.jpg);"> <a class="categoryBar-list-link" href="categories/HtmlCss/">HtmlCss</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">前端技术</span></li><li class="categoryBar-list-item" style="background:url(https://www.cdn.cheneyblog.com//blog/202401171734524.jpg);"> <a class="categoryBar-list-link" href="categories/TDSQL/">TDSQL</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">分布式数据库TDSQL</span></li><li class="categoryBar-list-item" style="background:url(https://www.cdn.cheneyblog.com//blog/202401171658771.webp);"> <a class="categoryBar-list-link" href="categories/WebEcology/">WebEcology</a><span class="categoryBar-list-count">17</span><span class="categoryBar-list-descr">Web科学</span></li><li class="categoryBar-list-item" style="background:url(https://www.cdn.cheneyblog.com//blog/202401171737563.jpg);"> <a class="categoryBar-list-link" href="categories/Java/">Java</a><span class="categoryBar-list-count">23</span><span class="categoryBar-list-descr">Java开发指南</span></li><li class="categoryBar-list-item" style="background:url(https://www.cdn.cheneyblog.com//blog/202401171739452.webp);"> <a class="categoryBar-list-link" href="categories/Oracle/">Oracle</a><span class="categoryBar-list-count">43</span><span class="categoryBar-list-descr">Oracle技术手册</span></li><li class="categoryBar-list-item" style="background:url(https://www.cdn.cheneyblog.com//blog/202401171613706.webp);"> <a class="categoryBar-list-link" href="categories/Python/">Python</a><span class="categoryBar-list-count">27</span><span class="categoryBar-list-descr">Python之旅</span></li><li class="categoryBar-list-item" style="background:url(https://www.cdn.cheneyblog.com//blog/202401171743136.webp);"> <a class="categoryBar-list-link" href="categories/Tools/">Tools</a><span class="categoryBar-list-count">7</span><span class="categoryBar-list-descr">程序猿开发工具集</span></li></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><!-- hexo injector body_end end --></body></html>